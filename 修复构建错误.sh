#!/bin/bash

echo "═══════════════════════════════════════════════════════"
echo "   修复 Next.js 构建错误"
echo "═══════════════════════════════════════════════════════"
echo ""

# 停止服务器
echo "1. 停止运行中的服务器..."
pkill -f "next dev" 2>/dev/null || true
sleep 2

# 清理构建缓存
echo "2. 清理构建缓存..."
rm -rf .next
echo "   ✅ 构建缓存已清理"

# 重新构建
echo "3. 重新构建项目..."
npm run build
echo "   ✅ 构建完成"

# 启动服务器
echo "4. 启动开发服务器..."
echo ""
echo "═══════════════════════════════════════════════════════"
echo "   服务器启动后，请在浏览器中访问："
echo "   http://localhost:3000/"
echo ""
echo "   ⚠️  请保持此窗口打开"
echo "═══════════════════════════════════════════════════════"
echo ""

npm run dev
